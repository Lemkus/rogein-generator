<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ò–≥—Ä–∞-—Å–∏–º—É–ª—è—Ç–æ—Ä –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        
        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .game-title {
            font-size: 2.5em;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .game-subtitle {
            font-size: 1.2em;
            opacity: 0.8;
            margin: 10px 0;
        }
        
        .game-area {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .runner-view {
            flex: 2;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }
        
        .controls {
            flex: 1;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
        }
        
        .runner {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ff6b6b;
            border-radius: 50%;
            border: 3px solid white;
            transition: all 0.3s ease;
            z-index: 10;
        }
        
        .trail {
            position: absolute;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
            transition: all 0.3s ease;
        }
        
        .trail.horizontal {
            height: 6px;
        }
        
        .trail.vertical {
            width: 6px;
        }
        
        .trail.diagonal {
            width: 6px;
            transform-origin: left center;
        }
        
        .target-point {
            position: absolute;
            width: 15px;
            height: 15px;
            background: #4ecdc4;
            border-radius: 50%;
            border: 2px solid white;
            animation: pulse 2s infinite;
        }
        
        .target-point.reached {
            background: #45b7aa;
            animation: none;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .path-choice {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid transparent;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .path-choice:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: #4ecdc4;
        }
        
        .path-choice.selected {
            background: rgba(78, 205, 196, 0.3);
            border-color: #4ecdc4;
        }
        
        .path-choice.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .game-stats {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #4ecdc4;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.8;
        }
        
        .game-controls {
            text-align: center;
            margin: 20px 0;
        }
        
        button {
            background: #4ecdc4;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: #45b7aa;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .audio-controls {
            margin: 15px 0;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }
        
        .audio-toggle {
            background: #ff6b6b;
        }
        
        .audio-toggle.active {
            background: #4ecdc4;
        }
        
        .instructions {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        .navigation-status {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 10px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }
        
        .navigation-status.navigating {
            background: rgba(78, 205, 196, 0.3);
        }
        
        .navigation-status.reached {
            background: rgba(45, 183, 170, 0.3);
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <h1 class="game-title">üèÉ‚Äç‚ôÇÔ∏è –°–∏–º—É–ª—è—Ç–æ—Ä –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</h1>
            <p class="game-subtitle">–°–ª—É—à–∞–π—Ç–µ –∑–≤—É–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –∏ –≤—ã–±–∏—Ä–∞–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç—Ä–æ–ø—ã!</p>
        </div>
        
        <div class="game-stats">
            <div class="stat">
                <div class="stat-value" id="currentDistance">--</div>
                <div class="stat-label">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ —Ü–µ–ª–∏</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="currentSpeed">5</div>
                <div class="stat-label">–°–∫–æ—Ä–æ—Å—Ç—å (–∫–º/—á)</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="pointsReached">0</div>
                <div class="stat-label">–¢–æ—á–µ–∫ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="gameTime">00:00</div>
                <div class="stat-label">–í—Ä–µ–º—è –∏–≥—Ä—ã</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="runner-view" id="runnerView">
                <!-- –ë–µ–≥—É–Ω –∏ —Ç—Ä–æ–ø—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <div class="controls">
                <div class="audio-controls">
                    <button id="audioToggle" class="audio-toggle">üîá –í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫</button>
                    <div class="navigation-status" id="navStatus">–ì–æ—Ç–æ–≤ –∫ —Å—Ç–∞—Ä—Ç—É</div>
                </div>
                
                <div id="pathChoices">
                    <!-- –í—ã–±–æ—Ä—ã —Ç—Ä–æ–ø –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <div class="game-controls">
                    <button id="startGame" disabled>üéØ –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                    <button id="pauseGame" disabled>‚è∏Ô∏è –ü–∞—É–∑–∞</button>
                    <button id="resetGame">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
                </div>
                
                <div class="instructions">
                    <h4>üéÆ –ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</h4>
                    <ol>
                        <li>–ù–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É"</li>
                        <li>–°–ª—É—à–∞–π—Ç–µ –∑–≤—É–∫–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</li>
                        <li>–í—ã–±–∏—Ä–∞–π—Ç–µ —Ç—Ä–æ–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ–¥—É—Ç –∫ —Ü–µ–ª–∏</li>
                        <li>–î–æ—Å—Ç–∏–≥–∞–π—Ç–µ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫!</li>
                    </ol>
                    
                    <h4>üîä –ó–≤—É–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏:</h4>
                    <ul>
                        <li><strong>–í—ã—Å–æ–∫–∏–π —Ç–æ–Ω:</strong> –ë–ª–∏–∑–∫–æ –∫ —Ü–µ–ª–∏</li>
                        <li><strong>–ù–∏–∑–∫–∏–π —Ç–æ–Ω:</strong> –î–∞–ª–µ–∫–æ –æ—Ç —Ü–µ–ª–∏</li>
                        <li><strong>–í–æ—Å—Ö–æ–¥—è—â–∏–π:</strong> –ü—Ä–∏–±–ª–∏–∂–∞–µ—Ç–µ—Å—å</li>
                        <li><strong>–ù–∏—Å—Ö–æ–¥—è—â–∏–π:</strong> –£–¥–∞–ª—è–µ—Ç–µ—Å—å</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { playSoundPattern, playDirectionSound, toggleAudio, isAudioOn } from './src/modules/audioModuleImproved.js';
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameState = {
            isRunning: false,
            isPaused: false,
            currentTarget: null,
            runnerPosition: { x: 50, y: 200 },
            trails: [],
            targetPoints: [],
            pointsReached: 0,
            startTime: null,
            gameTime: 0,
            lastDistance: null,
            navigationActive: false
        };
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const runnerView = document.getElementById('runnerView');
        const pathChoices = document.getElementById('pathChoices');
        const audioToggle = document.getElementById('audioToggle');
        const navStatus = document.getElementById('navStatus');
        const startGame = document.getElementById('startGame');
        const pauseGame = document.getElementById('pauseGame');
        const resetGame = document.getElementById('resetGame');
        
        // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        const currentDistance = document.getElementById('currentDistance');
        const currentSpeed = document.getElementById('currentSpeed');
        const pointsReached = document.getElementById('pointsReached');
        const gameTime = document.getElementById('gameTime');
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            createTrails();
            createTargetPoints();
            updateRunnerPosition();
            updatePathChoices();
            updateStats();
            
            startGame.disabled = false;
            console.log('üéÆ –ò–≥—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–æ–ø
        function createTrails() {
            gameState.trails = [
                { id: 1, start: { x: 50, y: 200 }, end: { x: 150, y: 150 }, direction: 'northeast' },
                { id: 2, start: { x: 50, y: 200 }, end: { x: 150, y: 250 }, direction: 'southeast' },
                { id: 3, start: { x: 50, y: 200 }, end: { x: 200, y: 200 }, direction: 'east' },
                { id: 4, start: { x: 150, y: 150 }, end: { x: 250, y: 100 }, direction: 'northeast' },
                { id: 5, start: { x: 150, y: 150 }, end: { x: 250, y: 200 }, direction: 'east' },
                { id: 6, start: { x: 150, y: 250 }, end: { x: 250, y: 200 }, direction: 'northeast' },
                { id: 7, start: { x: 150, y: 250 }, end: { x: 250, y: 300 }, direction: 'southeast' },
                { id: 8, start: { x: 200, y: 200 }, end: { x: 300, y: 150 }, direction: 'northeast' },
                { id: 9, start: { x: 200, y: 200 }, end: { x: 300, y: 250 }, direction: 'southeast' }
            ];
            
            renderTrails();
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤—ã—Ö —Ç–æ—á–µ–∫
        function createTargetPoints() {
            gameState.targetPoints = [
                { id: 1, x: 250, y: 100, reached: false },
                { id: 2, x: 300, y: 150, reached: false },
                { id: 3, x: 250, y: 300, reached: false }
            ];
            
            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é —Ü–µ–ª–µ–≤—É—é —Ç–æ—á–∫—É
            gameState.currentTarget = gameState.targetPoints[Math.floor(Math.random() * gameState.targetPoints.length)];
            renderTargetPoints();
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ç—Ä–æ–ø
        function renderTrails() {
            const trailsHtml = gameState.trails.map(trail => {
                const length = Math.sqrt(Math.pow(trail.end.x - trail.start.x, 2) + Math.pow(trail.end.y - trail.start.y, 2));
                const angle = Math.atan2(trail.end.y - trail.start.y, trail.end.x - trail.start.x) * 180 / Math.PI;
                
                return `
                    <div class="trail diagonal" 
                         style="left: ${trail.start.x}px; top: ${trail.start.y}px; 
                                width: ${length}px; transform: rotate(${angle}deg);">
                    </div>
                `;
            }).join('');
            
            runnerView.innerHTML = trailsHtml;
        }
        
        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ü–µ–ª–µ–≤—ã—Ö —Ç–æ—á–µ–∫
        function renderTargetPoints() {
            const pointsHtml = gameState.targetPoints.map(point => {
                const isCurrent = point.id === gameState.currentTarget.id;
                return `
                    <div class="target-point ${point.reached ? 'reached' : ''}" 
                         style="left: ${point.x}px; top: ${point.y}px;
                                ${isCurrent ? 'border-color: #ff6b6b; border-width: 3px;' : ''}">
                    </div>
                `;
            }).join('');
            
            runnerView.innerHTML += pointsHtml;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –±–µ–≥—É–Ω–∞
        function updateRunnerPosition() {
            let runnerHtml = runnerView.querySelector('.runner');
            if (!runnerHtml) {
                runnerHtml = document.createElement('div');
                runnerHtml.className = 'runner';
                runnerView.appendChild(runnerHtml);
            }
            
            runnerHtml.style.left = gameState.runnerPosition.x + 'px';
            runnerHtml.style.top = gameState.runnerPosition.y + 'px';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞ —Ç—Ä–æ–ø
        function updatePathChoices() {
            const availableTrails = gameState.trails.filter(trail => 
                trail.start.x === gameState.runnerPosition.x && 
                trail.start.y === gameState.runnerPosition.y
            );
            
            if (availableTrails.length === 0) {
                pathChoices.innerHTML = '<div class="path-choice disabled">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Ç—Ä–æ–ø</div>';
                return;
            }
            
            const choicesHtml = availableTrails.map(trail => {
                const directionNames = {
                    'northeast': '‚ÜóÔ∏è –°–µ–≤–µ—Ä–æ-–≤–æ—Å—Ç–æ–∫',
                    'southeast': '‚ÜòÔ∏è –Æ–≥–æ-–≤–æ—Å—Ç–æ–∫', 
                    'east': '‚û°Ô∏è –í–æ—Å—Ç–æ–∫'
                };
                
                return `
                    <div class="path-choice" onclick="selectPath(${trail.id})">
                        ${directionNames[trail.direction]}
                    </div>
                `;
            }).join('');
            
            pathChoices.innerHTML = choicesHtml;
        }
        
        // –í—ã–±–æ—Ä —Ç—Ä–æ–ø—ã
        window.selectPath = function(trailId) {
            if (!gameState.isRunning || gameState.isPaused) return;
            
            const trail = gameState.trails.find(t => t.id === trailId);
            if (!trail) return;
            
            // –î–≤–∏–≥–∞–µ–º –±–µ–≥—É–Ω–∞ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ç—Ä–æ–ø–µ
            moveRunner(trail);
        };
        
        // –î–≤–∏–∂–µ–Ω–∏–µ –±–µ–≥—É–Ω–∞
        function moveRunner(trail) {
            const steps = 20;
            const stepX = (trail.end.x - trail.start.x) / steps;
            const stepY = (trail.end.y - trail.start.y) / steps;
            
            let currentStep = 0;
            
            const moveInterval = setInterval(() => {
                if (!gameState.isRunning || gameState.isPaused) {
                    clearInterval(moveInterval);
                    return;
                }
                
                currentStep++;
                gameState.runnerPosition.x = trail.start.x + (stepX * currentStep);
                gameState.runnerPosition.y = trail.start.y + (stepY * currentStep);
                
                updateRunnerPosition();
                updateNavigation();
                
                if (currentStep >= steps) {
                    clearInterval(moveInterval);
                    gameState.runnerPosition.x = trail.end.x;
                    gameState.runnerPosition.y = trail.end.y;
                    updateRunnerPosition();
                    updatePathChoices();
                    checkTargetReached();
                }
            }, 100);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
        function updateNavigation() {
            if (!gameState.currentTarget) return;
            
            const distance = Math.sqrt(
                Math.pow(gameState.currentTarget.x - gameState.runnerPosition.x, 2) + 
                Math.pow(gameState.currentTarget.y - gameState.runnerPosition.y, 2)
            );
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            currentDistance.textContent = Math.round(distance) + 'px';
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è
            let direction = 'neutral';
            if (gameState.lastDistance !== null) {
                if (distance < gameState.lastDistance - 5) {
                    direction = 'approaching';
                } else if (distance > gameState.lastDistance + 5) {
                    direction = 'moving_away';
                }
            }
            
            // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            if (isAudioOn() && gameState.isRunning) {
                let pattern;
                if (distance < 30) {
                    pattern = [100]; // –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ
                } else if (distance < 60) {
                    pattern = [150]; // –ì–æ—Ä—è—á–æ
                } else if (distance < 100) {
                    pattern = [200]; // –¢–µ–ø–ª–æ
                } else if (distance < 150) {
                    pattern = [250]; // –ü—Ä–æ—Ö–ª–∞–¥–Ω–æ
                } else {
                    pattern = [300]; // –•–æ–ª–æ–¥–Ω–æ
                }
                
                playSoundPattern(pattern, direction, distance);
                
                if (direction !== 'neutral') {
                    setTimeout(() => playDirectionSound(direction), 200);
                }
            }
            
            gameState.lastDistance = distance;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            if (distance < 30) {
                navStatus.textContent = 'üéØ –û—á–µ–Ω—å –±–ª–∏–∑–∫–æ!';
                navStatus.className = 'navigation-status navigating';
            } else if (distance < 100) {
                navStatus.textContent = `üìç ${Math.round(distance)}px –¥–æ —Ü–µ–ª–∏`;
                navStatus.className = 'navigation-status navigating';
            } else {
                navStatus.textContent = `üìç ${Math.round(distance)}px –¥–æ —Ü–µ–ª–∏`;
                navStatus.className = 'navigation-status';
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏
        function checkTargetReached() {
            if (!gameState.currentTarget) return;
            
            const distance = Math.sqrt(
                Math.pow(gameState.currentTarget.x - gameState.runnerPosition.x, 2) + 
                Math.pow(gameState.currentTarget.y - gameState.runnerPosition.y, 2)
            );
            
            if (distance < 20) {
                // –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!
                gameState.currentTarget.reached = true;
                gameState.pointsReached++;
                
                // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ü–µ–ª–∏
                if (isAudioOn()) {
                    playSoundPattern([200, 100, 200, 100, 200], 'neutral', 0);
                }
                
                navStatus.textContent = 'üéâ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!';
                navStatus.className = 'navigation-status reached';
                
                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é —Ü–µ–ª—å
                setTimeout(() => {
                    const unreachedPoints = gameState.targetPoints.filter(p => !p.reached);
                    if (unreachedPoints.length > 0) {
                        gameState.currentTarget = unreachedPoints[Math.floor(Math.random() * unreachedPoints.length)];
                        gameState.lastDistance = null;
                        renderTargetPoints();
                        updatePathChoices();
                        navStatus.textContent = 'üéØ –ù–æ–≤–∞—è —Ü–µ–ª—å –≤—ã–±—Ä–∞–Ω–∞!';
                        navStatus.className = 'navigation-status navigating';
                    } else {
                        // –í—Å–µ —Ü–µ–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã!
                        endGame();
                    }
                }, 2000);
            }
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            pointsReached.textContent = gameState.pointsReached;
            
            if (gameState.startTime) {
                gameState.gameTime = Math.floor((Date.now() - gameState.startTime) / 1000);
                const minutes = Math.floor(gameState.gameTime / 60);
                const seconds = gameState.gameTime % 60;
                gameTime.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }
        
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function endGame() {
            gameState.isRunning = false;
            startGame.disabled = false;
            pauseGame.disabled = true;
            
            navStatus.textContent = 'üèÜ –í—Å–µ —Ü–µ–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç—ã!';
            navStatus.className = 'navigation-status reached';
            
            alert(`üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ –≤—Å–µ—Ö —Ü–µ–ª–µ–π –∑–∞ ${gameTime.textContent}!`);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        audioToggle.addEventListener('click', () => {
            const isOn = toggleAudio();
            audioToggle.textContent = isOn ? 'üîä –û—Ç–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫' : 'üîá –í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫';
            audioToggle.className = `audio-toggle ${isOn ? 'active' : ''}`;
        });
        
        startGame.addEventListener('click', () => {
            gameState.isRunning = true;
            gameState.isPaused = false;
            gameState.startTime = Date.now();
            gameState.lastDistance = null;
            
            startGame.disabled = true;
            pauseGame.disabled = false;
            
            navStatus.textContent = 'üèÉ‚Äç‚ôÇÔ∏è –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å!';
            navStatus.className = 'navigation-status navigating';
            
            updatePathChoices();
            updateNavigation();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            const statsInterval = setInterval(() => {
                if (!gameState.isRunning) {
                    clearInterval(statsInterval);
                    return;
                }
                updateStats();
            }, 1000);
        });
        
        pauseGame.addEventListener('click', () => {
            gameState.isPaused = !gameState.isPaused;
            pauseGame.textContent = gameState.isPaused ? '‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å' : '‚è∏Ô∏è –ü–∞—É–∑–∞';
            navStatus.textContent = gameState.isPaused ? '‚è∏Ô∏è –ò–≥—Ä–∞ –Ω–∞ –ø–∞—É–∑–µ' : 'üèÉ‚Äç‚ôÇÔ∏è –ò–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è';
        });
        
        resetGame.addEventListener('click', () => {
            gameState = {
                isRunning: false,
                isPaused: false,
                currentTarget: null,
                runnerPosition: { x: 50, y: 200 },
                trails: [],
                targetPoints: [],
                pointsReached: 0,
                startTime: null,
                gameTime: 0,
                lastDistance: null,
                navigationActive: false
            };
            
            startGame.disabled = false;
            pauseGame.disabled = true;
            pauseGame.textContent = '‚è∏Ô∏è –ü–∞—É–∑–∞';
            
            navStatus.textContent = '–ì–æ—Ç–æ–≤ –∫ —Å—Ç–∞—Ä—Ç—É';
            navStatus.className = 'navigation-status';
            
            initGame();
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            initGame();
            console.log('üéÆ –ò–≥—Ä–∞-—Å–∏–º—É–ª—è—Ç–æ—Ä –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
        });
    </script>
</body>
</html>

