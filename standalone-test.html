<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ç–µ—Å—Ç –º–æ–¥—É–ª–µ–π</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
    .success { background: #d4edda; border-color: #c3e6cb; }
    .error { background: #f8d7da; border-color: #f5c6cb; }
    .info { background: #d1ecf1; border-color: #bee5eb; }
    pre { background: #f8f9fa; padding: 10px; border: 1px solid #dee2e6; overflow-x: auto; font-size: 11px; }
    .file-content { max-height: 300px; overflow-y: auto; }
    .module-info { background: #fff3cd; border-color: #ffeaa7; }
  </style>
</head>
<body>
  <h1>üîç –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π —Ç–µ—Å—Ç –º–æ–¥—É–ª–µ–π (–±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞)</h1>
  
  <div id="results"></div>
  
  <script>
    const results = document.getElementById('results');
    
    function addResult(message, type = 'info') {
      const div = document.createElement('div');
      div.className = `test ${type}`;
      div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
      results.appendChild(div);
      console.log(message);
    }
    
    function addFileContent(title, content, type = 'info') {
      const div = document.createElement('div');
      div.className = `test ${type}`;
      div.innerHTML = `<strong>${title}</strong><pre class="file-content">${content}</pre>`;
      results.appendChild(div);
    }
    
    function addModuleInfo(title, info, type = 'module-info') {
      const div = document.createElement('div');
      div.className = `test ${type}`;
      div.innerHTML = `<strong>${title}</strong><pre>${info}</pre>`;
      results.appendChild(div);
    }
    
    addResult('–ù–∞—á–∏–Ω–∞—é –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π...', 'info');
    
    // –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ ES6 –º–æ–¥—É–ª–µ–π
    try {
      addResult('‚úÖ ES6 –º–æ–¥—É–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è', 'success');
    } catch (error) {
      addResult(`‚ùå ES6 –º–æ–¥—É–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è: ${error.message}`, 'error');
    }
    
    // –¢–µ—Å—Ç 2: –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
    addResult('–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞...', 'info');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞
    const projectFiles = [
      'index.html',
      'debug-index.html',
      'simple-test.html',
      'direct-test.html',
      'offline-test.html'
    ];
    
    projectFiles.forEach(file => {
      fetch(file)
        .then(response => {
          if (response.ok) {
            addResult(`‚úÖ ${file} –¥–æ—Å—Ç—É–ø–µ–Ω`, 'success');
          } else {
            addResult(`‚ùå ${file} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${response.status}`, 'error');
          }
        })
        .catch(error => {
          addResult(`‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è ${file}: ${error.message}`, 'error');
        });
    });
    
    // –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π
    addResult('–ü—Ä–æ–≤–µ—Ä—è—é –º–æ–¥—É–ª–∏...', 'info');
    
    const modules = [
      { name: 'app.js', path: './src/app.js' },
      { name: 'mapModule.js', path: './src/modules/mapModule.js' },
      { name: 'navigation.js', path: './src/modules/navigation.js' },
      { name: 'pointGeneration.js', path: './src/modules/pointGeneration.js' },
      { name: 'algorithms.js', path: './src/modules/algorithms.js' },
      { name: 'utils.js', path: './src/modules/utils.js' },
      { name: 'overpassAPI.js', path: './src/modules/overpassAPI.js' }
    ];
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –º–æ–¥—É–ª—è
    async function analyzeModule(module) {
      try {
        const response = await fetch(module.path);
        if (response.ok) {
          const content = await response.text();
          addResult(`‚úÖ ${module.name} –¥–æ—Å—Ç—É–ø–µ–Ω (${content.length} —Å–∏–º–≤–æ–ª–æ–≤)`, 'success');
          
          // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
          const lines = content.split('\n');
          const imports = lines.filter(line => line.trim().startsWith('import'));
          const exports = lines.filter(line => line.trim().startsWith('export'));
          const functions = lines.filter(line => line.trim().startsWith('function') || line.trim().includes('function'));
          
          const analysis = `–†–∞–∑–º–µ—Ä: ${content.length} —Å–∏–º–≤–æ–ª–æ–≤
–°—Ç—Ä–æ–∫: ${lines.length}
–ò–º–ø–æ—Ä—Ç—ã: ${imports.length}
–≠–∫—Å–ø–æ—Ä—Ç—ã: ${exports.length}
–§—É–Ω–∫—Ü–∏–∏: ${functions.length}

–ò–º–ø–æ—Ä—Ç—ã:
${imports.slice(0, 5).join('\n')}

–≠–∫—Å–ø–æ—Ä—Ç—ã:
${exports.slice(0, 5).join('\n')}

–ü–µ—Ä–≤—ã–µ 400 —Å–∏–º–≤–æ–ª–æ–≤:
${content.substring(0, 400)}...`;
          
          addModuleInfo(`–ê–Ω–∞–ª–∏–∑ ${module.name}:`, analysis);
          
        } else {
          addResult(`‚ùå ${module.name} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${response.status} ${response.statusText}`, 'error');
        }
      } catch (error) {
        addResult(`‚ùå –û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è ${module.name}: ${error.message}`, 'error');
      }
    }
    
    // –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –º–æ–¥—É–ª–∏
    modules.forEach(module => {
      analyzeModule(module);
    });
    
    // –¢–µ—Å—Ç 4: –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª—è
    setTimeout(() => {
      addResult('–ü—Ä–æ–±—É—é –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–æ–¥—É–ª—å app.js...', 'info');
      
      const script = document.createElement('script');
      script.type = 'module';
      script.textContent = `
        try {
          import('./src/app.js')
            .then(module => {
              console.log('‚úÖ app.js –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
              console.log('–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:', Object.keys(module));
              
              if (typeof module.initApp === 'function') {
                console.log('‚úÖ –§—É–Ω–∫—Ü–∏—è initApp –Ω–∞–π–¥–µ–Ω–∞');
                // –ü—Ä–æ–±—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                try {
                  module.initApp();
                  console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–æ');
                } catch (error) {
                  console.error('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
                }
              } else {
                console.error('‚ùå –§—É–Ω–∫—Ü–∏—è initApp –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
              }
            })
            .catch(error => {
              console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ app.js:', error);
              console.error('–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:', error);
            });
        } catch (error) {
          console.error('‚ùå –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ app.js:', error);
        }
      `;
      
      document.head.appendChild(script);
    }, 3000);
    
    // –¢–µ—Å—Ç 5: –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º
    addResult('–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º...', 'info');
    
    setTimeout(() => {
      addResult('üìã –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –ø—Ä–æ–±–ª–µ–º:', 'info');
      addResult('1. CORS –æ—à–∏–±–∫–∏ - –º–æ–¥—É–ª–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –±—Ä–∞—É–∑–µ—Ä–æ–º', 'info');
      addResult('2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º', 'info');
      addResult('3. –û—à–∏–±–∫–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ –≤ –º–æ–¥—É–ª—è—Ö', 'info');
      addResult('4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞', 'info');
      addResult('5. –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π —Ñ–∞–π–ª–æ–≤', 'info');
      
      addResult('üîß –†–µ—à–µ–Ω–∏—è:', 'info');
      addResult('1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (python -m http.server 8000)', 'info');
      addResult('2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –º–æ–¥—É–ª–µ–π', 'info');
      addResult('3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –ø—É—Ç–∏', 'info');
      addResult('4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)', 'info');
    }, 5000);
    
    // –¢–µ—Å—Ç 6: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Å–æ–ª–∏
    addResult('üì± –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤', 'info');
    addResult('–í—Å–µ –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π –±—É–¥—É—Ç –ø–æ–∫–∞–∑–∞–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª–∏', 'info');
  </script>
</body>
</html>

