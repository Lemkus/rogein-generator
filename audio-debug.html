<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–û—Ç–ª–∞–¥–∫–∞ –∑–≤—É–∫–æ–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .control-group {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .control-group h3 {
            margin-top: 0;
            color: #4ecdc4;
        }
        
        .input-group {
            display: flex;
            align-items: center;
            margin: 15px 0;
            gap: 15px;
        }
        
        label {
            min-width: 120px;
            font-weight: bold;
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4ecdc4;
            cursor: pointer;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #4ecdc4;
            cursor: pointer;
            border: none;
        }
        
        .value-display {
            min-width: 80px;
            text-align: center;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        button {
            background: #4ecdc4;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 10px 5px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        button:hover {
            background: #45b7aa;
            transform: translateY(-2px);
        }
        
        button:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }
        
        .audio-toggle {
            background: #ff6b6b;
        }
        
        .audio-toggle.active {
            background: #4ecdc4;
        }
        
        .info-panel {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .info-panel h3 {
            color: #4ecdc4;
            margin-top: 0;
        }
        
        .info-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .info-label {
            font-weight: bold;
        }
        
        .info-value {
            color: #4ecdc4;
        }
        
        .status {
            text-align: center;
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            font-weight: bold;
            font-size: 18px;
        }
        
        .status.approaching {
            background: rgba(78, 205, 196, 0.3);
            border: 2px solid #4ecdc4;
        }
        
        .status.moving-away {
            background: rgba(255, 107, 107, 0.3);
            border: 2px solid #ff6b6b;
        }
        
        .status.neutral {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #ccc;
        }
        
        .examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .example-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid #4ecdc4;
            color: white;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .example-btn:hover {
            background: rgba(78, 205, 196, 0.2);
            transform: translateY(-2px);
        }
        
        .example-btn h4 {
            margin: 0 0 10px 0;
            color: #4ecdc4;
        }
        
        .example-btn p {
            margin: 5px 0;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéµ –û—Ç–ª–∞–¥–∫–∞ –∑–≤—É–∫–æ–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</h1>
        
        <div class="control-group">
            <h3>üéõÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–≤—É–∫–æ–º</h3>
            <div class="input-group">
                <button id="audioToggle" class="audio-toggle">üîá –í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫</button>
                <button id="playTestSound">üéµ –ü—Ä–æ–∏–≥—Ä–∞—Ç—å —Ç–µ—Å—Ç</button>
                <button id="playVictorySound">üèÜ –ó–≤—É–∫ –ø–æ–±–µ–¥—ã</button>
                <button id="startContinuousPlay">üîÑ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ</button>
                <button id="startMovementSimulation">üèÉ‚Äç‚ôÇÔ∏è –°–∏–º—É–ª—è—Ü–∏—è</button>
                <button id="startAutoTest">üéØ –ê–≤—Ç–æ—Ç–µ—Å—Ç</button>
            </div>
        </div>
        
        <div class="control-group">
            <h3>üìè –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞–≤–∏–≥–∞—Ü–∏–∏</h3>
            <div class="input-group">
                <label>–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ:</label>
                <input type="range" id="distanceSlider" min="10" max="200" value="100">
                <div class="value-display" id="distanceValue">100 –º</div>
            </div>
            
            <div class="input-group">
                <label>–°–∫–æ—Ä–æ—Å—Ç—å:</label>
                <input type="range" id="speedSlider" min="-10" max="10" value="0" step="0.5">
                <div class="value-display" id="speedValue">0 –º/—Å</div>
            </div>
        </div>
        
        <div class="info-panel">
            <h3>üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–≤—É–∫–µ</h3>
            <div class="info-item">
                <span class="info-label">–ë–∞–∑–æ–≤–∞—è —á–∞—Å—Ç–æ—Ç–∞:</span>
                <span class="info-value" id="frequencyValue">-- Hz</span>
            </div>
            <div class="info-item">
                <span class="info-label">–ò–Ω—Ç–µ—Ä–≤–∞–ª –∑–≤—É–∫–æ–≤:</span>
                <span class="info-value" id="intervalValue">-- —Å–µ–∫</span>
            </div>
            <div class="info-item">
                <span class="info-label">–¢–∏–ø –∞–∫–∫–æ—Ä–¥–∞:</span>
                <span class="info-value" id="chordType">--</span>
            </div>
            <div class="info-item">
                <span class="info-label">–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:</span>
                <span class="info-value" id="directionValue">--</span>
            </div>
        </div>
        
        <div class="status" id="statusDisplay">
            –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
        </div>
        
        <div class="info-panel" id="simulationPanel" style="display: none;">
            <h3>üèÉ‚Äç‚ôÇÔ∏è –°–∏–º—É–ª—è—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è</h3>
            <div class="info-item">
                <span class="info-label">–¢–µ–∫—É—â–µ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ:</span>
                <span class="info-value" id="simDistance">-- –º</span>
            </div>
            <div class="info-item">
                <span class="info-label">–°–∫–æ—Ä–æ—Å—Ç—å:</span>
                <span class="info-value" id="simSpeed">-- –º/—Å</span>
            </div>
            <div class="info-item">
                <span class="info-label">–í—Ä–µ–º—è –¥–æ —Ü–µ–ª–∏:</span>
                <span class="info-value" id="simTimeToTarget">-- —Å–µ–∫</span>
            </div>
            <div class="info-item">
                <span class="info-label">–°—Ç–∞—Ç—É—Å:</span>
                <span class="info-value" id="simStatus">--</span>
            </div>
        </div>
        
        <div class="info-panel">
            <h3>üéÆ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h3>
            <ul>
                <li><strong>üéµ –ü—Ä–æ–∏–≥—Ä–∞—Ç—å —Ç–µ—Å—Ç</strong> - –ø—Ä–æ–∏–≥—Ä–∞—Ç—å –∑–≤—É–∫ –æ–¥–∏–Ω —Ä–∞–∑ —Å —Ç–µ–∫—É—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</li>
                <li><strong>üèÜ –ó–≤—É–∫ –ø–æ–±–µ–¥—ã</strong> - –ø—Ä–æ–∏–≥—Ä–∞—Ç—å —Ç—Ä–∏—É–º—Ñ–∞–ª—å–Ω—ã–π –∞–∫–∫–æ—Ä–¥ (–∫–∞–∫ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ —Ü–µ–ª–∏)</li>
                <li><strong>üîÑ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ</strong> - –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç—å –∑–≤—É–∫–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏</li>
                <li><strong>üèÉ‚Äç‚ôÇÔ∏è –°–∏–º—É–ª—è—Ü–∏—è</strong> - —Ä–µ–∞–ª—å–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è –∫ —Ü–µ–ª–∏ —Å –∏–∑–º–µ–Ω—è—é—â–∏–º—Å—è –∑–≤—É–∫–æ–º</li>
                <li><strong>üéØ –ê–≤—Ç–æ—Ç–µ—Å—Ç</strong> - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ—Ç –∑–≤—É–∫–∏</li>
                <li><strong>–°–ª–∞–π–¥–µ—Ä—ã</strong> - –º–µ–Ω—è–π—Ç–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å, –∑–≤—É–∫ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</li>
                <li><strong>–ü—Ä–∏–º–µ—Ä—ã</strong> - –≥–æ—Ç–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</li>
            </ul>
        </div>
        
        <div class="control-group">
            <h3>üéØ –ü—Ä–∏–º–µ—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è</h3>
            <div class="examples">
                <div class="example-btn" data-distance="20" data-speed="2">
                    <h4>–ë–ª–∏–∑–∫–æ + –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ</h4>
                    <p>20–º, +2 –º/—Å</p>
                    <p>–í—ã—Å–æ–∫–∏–π —Ç–æ–Ω, –º–∞–∂–æ—Ä</p>
                </div>
                
                <div class="example-btn" data-distance="20" data-speed="-2">
                    <h4>–ë–ª–∏–∑–∫–æ + –£–¥–∞–ª–µ–Ω–∏–µ</h4>
                    <p>20–º, -2 –º/—Å</p>
                    <p>–í—ã—Å–æ–∫–∏–π —Ç–æ–Ω, –º–∏–Ω–æ—Ä</p>
                </div>
                
                <div class="example-btn" data-distance="100" data-speed="1">
                    <h4>–°—Ä–µ–¥–Ω–µ + –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ</h4>
                    <p>100–º, +1 –º/—Å</p>
                    <p>–°—Ä–µ–¥–Ω–∏–π —Ç–æ–Ω, –º–∞–∂–æ—Ä</p>
                </div>
                
                <div class="example-btn" data-distance="100" data-speed="-1">
                    <h4>–°—Ä–µ–¥–Ω–µ + –£–¥–∞–ª–µ–Ω–∏–µ</h4>
                    <p>100–º, -1 –º/—Å</p>
                    <p>–°—Ä–µ–¥–Ω–∏–π —Ç–æ–Ω, –º–∏–Ω–æ—Ä</p>
                </div>
                
                <div class="example-btn" data-distance="180" data-speed="0.5">
                    <h4>–î–∞–ª–µ–∫–æ + –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ</h4>
                    <p>180–º, +0.5 –º/—Å</p>
                    <p>–ù–∏–∑–∫–∏–π —Ç–æ–Ω, –º–∞–∂–æ—Ä</p>
                </div>
                
                <div class="example-btn" data-distance="180" data-speed="-0.5">
                    <h4>–î–∞–ª–µ–∫–æ + –£–¥–∞–ª–µ–Ω–∏–µ</h4>
                    <p>180–º, -0.5 –º/—Å</p>
                    <p>–ù–∏–∑–∫–∏–π —Ç–æ–Ω, –º–∏–Ω–æ—Ä</p>
                </div>
            </div>
        </div>
        
        <div class="info-panel">
            <h3>üìù –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã</h3>
            <ul>
                <li><strong>–ú–∞–∂–æ—Ä–Ω—ã–π –∞–∫–∫–æ—Ä–¥</strong> - –∫–æ–≥–¥–∞ –ø—Ä–∏–±–ª–∏–∂–∞–µ–º—Å—è –∫ —Ü–µ–ª–∏ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)</li>
                <li><strong>–ú–∏–Ω–æ—Ä–Ω—ã–π –∞–∫–∫–æ—Ä–¥</strong> - –∫–æ–≥–¥–∞ —É–¥–∞–ª—è–µ–º—Å—è –æ—Ç —Ü–µ–ª–∏ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å)</li>
                <li><strong>–í—ã—Å–æ—Ç–∞ —Ç–æ–Ω–∞</strong> - —á–µ–º –±–ª–∏–∂–µ –∫ —Ü–µ–ª–∏, —Ç–µ–º –≤—ã—à–µ —Ç–æ–Ω (200-800 Hz)</li>
                <li><strong>–ß–∞—Å—Ç–æ—Ç–∞ –∑–≤—É–∫–æ–≤</strong> - —á–µ–º –±–ª–∏–∂–µ –∫ —Ü–µ–ª–∏, —Ç–µ–º —á–∞—â–µ –∑–≤—É–∫–∏ (0.5-2 —Å–µ–∫)</li>
                <li><strong>–°–∫–æ—Ä–æ—Å—Ç—å 0</strong> - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</li>
            </ul>
        </div>
    </div>

    <script type="module">
        import { 
            playTestSound, 
            toggleAudio, 
            isAudioOn, 
            getBaseFrequency, 
            getSoundInterval,
            startMovementSimulation,
            stopMovementSimulation,
            getSimulationStatus,
            createVictorySound
        } from './src/modules/audioModuleSimple.js';
        
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const audioToggle = document.getElementById('audioToggle');
        const playTestBtn = document.getElementById('playTestSound');
        const playVictoryBtn = document.getElementById('playVictorySound');
        const startAutoTestBtn = document.getElementById('startAutoTest');
        const startMovementSimulationBtn = document.getElementById('startMovementSimulation');
        const distanceSlider = document.getElementById('distanceSlider');
        const speedSlider = document.getElementById('speedSlider');
        const distanceValue = document.getElementById('distanceValue');
        const speedValue = document.getElementById('speedValue');
        const frequencyValue = document.getElementById('frequencyValue');
        const intervalValue = document.getElementById('intervalValue');
        const chordTypeValue = document.getElementById('chordType');
        const directionValue = document.getElementById('directionValue');
        const statusDisplay = document.getElementById('statusDisplay');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã —Å–∏–º—É–ª—è—Ü–∏–∏
        const simulationPanel = document.getElementById('simulationPanel');
        const simDistance = document.getElementById('simDistance');
        const simSpeed = document.getElementById('simSpeed');
        const simTimeToTarget = document.getElementById('simTimeToTarget');
        const simStatus = document.getElementById('simStatus');
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let autoTestInterval = null;
        let continuousPlayInterval = null;
        let currentDistance = 100;
        let currentSpeed = 0;
        let isContinuousPlaying = false;
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
        function updateValues() {
            currentDistance = parseFloat(distanceSlider.value);
            currentSpeed = parseFloat(speedSlider.value);
            
            distanceValue.textContent = `${currentDistance} –º`;
            speedValue.textContent = `${currentSpeed} –º/—Å`;
            
            // –í—ã—á–∏—Å–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–≤—É–∫–∞
            const frequency = getBaseFrequency(currentDistance);
            const interval = getSoundInterval(currentDistance);
            
            frequencyValue.textContent = `${Math.round(frequency)} Hz`;
            intervalValue.textContent = `${interval.toFixed(1)} —Å–µ–∫`;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–∏–ø –∞–∫–∫–æ—Ä–¥–∞ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            let chordType, direction, statusClass;
            
            if (currentSpeed > 0) {
                chordType = '–ú–∞–∂–æ—Ä–Ω—ã–π';
                direction = '–ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ';
                statusClass = 'approaching';
            } else if (currentSpeed < 0) {
                chordType = '–ú–∏–Ω–æ—Ä–Ω—ã–π';
                direction = '–£–¥–∞–ª–µ–Ω–∏–µ';
                statusClass = 'moving-away';
            } else {
                chordType = '–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è';
                direction = '–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ';
                statusClass = 'neutral';
            }
            
            chordTypeValue.textContent = chordType;
            directionValue.textContent = direction;
            statusDisplay.textContent = `${direction} - ${chordType} –∞–∫–∫–æ—Ä–¥`;
            statusDisplay.className = `status ${statusClass}`;
        }
        
        // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–≤—É–∫–∞
        function playTest() {
            if (!isAudioOn()) {
                alert('–í–∫–ª—é—á–∏—Ç–µ –∑–≤—É–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!');
                return;
            }
            
            playTestSound(currentDistance, currentSpeed);
        }
        
        // –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
        function startContinuousPlay() {
            if (continuousPlayInterval) {
                clearInterval(continuousPlayInterval);
                continuousPlayInterval = null;
                isContinuousPlaying = false;
                return;
            }
            
            if (!isAudioOn()) {
                alert('–í–∫–ª—é—á–∏—Ç–µ –∑–≤—É–∫ –¥–ª—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è!');
                return;
            }
            
            isContinuousPlaying = true;
            
            // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫ —Å—Ä–∞–∑—É
            playTestSound(currentDistance, currentSpeed);
            
            // –ó–∞—Ç–µ–º –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏
            const playNext = () => {
                if (!isContinuousPlaying) return;
                
                const interval = getSoundInterval(currentDistance);
                continuousPlayInterval = setTimeout(() => {
                    if (isContinuousPlaying) {
                        playTestSound(currentDistance, currentSpeed);
                        playNext(); // –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–ª–∞–Ω–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π –∑–≤—É–∫
                    }
                }, interval * 1000);
            };
            
            playNext();
        }
        
        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
        function stopContinuousPlay() {
            if (continuousPlayInterval) {
                clearInterval(continuousPlayInterval);
                continuousPlayInterval = null;
            }
            isContinuousPlaying = false;
        }
        
        // –°–∏–º—É–ª—è—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è
        function startMovementSimulationMode() {
            if (!isAudioOn()) {
                alert('–í–∫–ª—é—á–∏—Ç–µ –∑–≤—É–∫ –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏!');
                return;
            }
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –¥—Ä—É–≥–∏–µ —Ä–µ–∂–∏–º—ã
            stopContinuousPlay();
            if (autoTestInterval) {
                clearInterval(autoTestInterval);
                autoTestInterval = null;
                startAutoTestBtn.textContent = 'üéØ –ê–≤—Ç–æ—Ç–µ—Å—Ç';
            }
            
            const initialDistance = parseFloat(distanceSlider.value);
            const speed = parseFloat(speedSlider.value);
            
            if (speed === 0) {
                alert('–°–∫–æ—Ä–æ—Å—Ç—å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å 0 –¥–ª—è —Å–∏–º—É–ª—è—Ü–∏–∏!');
                return;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å —Å–∏–º—É–ª—è—Ü–∏–∏
            simulationPanel.style.display = 'block';
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–∏–º—É–ª—è—Ü–∏—é
            startMovementSimulation(initialDistance, speed, (reached, distance) => {
                if (reached) {
                    // –î–æ—Å—Ç–∏–≥–ª–∏ —Ü–µ–ª–∏
                    simDistance.textContent = '0 –º';
                    simTimeToTarget.textContent = '0 —Å–µ–∫';
                    simStatus.textContent = 'üèÜ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!';
                    startMovementSimulationBtn.textContent = 'üèÉ‚Äç‚ôÇÔ∏è –°–∏–º—É–ª—è—Ü–∏—è';
                    statusDisplay.textContent = 'üèÜ –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞!';
                    statusDisplay.className = 'status reached';
                } else {
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
                    simDistance.textContent = `${Math.round(distance)} –º`;
                    simSpeed.textContent = `${speed} –º/—Å`;
                    
                    if (speed > 0) {
                        // –ü—Ä–∏–±–ª–∏–∂–∞–µ–º—Å—è
                        simTimeToTarget.textContent = `${Math.round(distance / speed)} —Å–µ–∫`;
                        simStatus.textContent = 'üèÉ‚Äç‚ôÇÔ∏è –ü—Ä–∏–±–ª–∏–∂–∞–µ–º—Å—è –∫ —Ü–µ–ª–∏';
                    } else {
                        // –£–¥–∞–ª—è–µ–º—Å—è
                        simTimeToTarget.textContent = '‚àû —Å–µ–∫';
                        simStatus.textContent = 'üö∂‚Äç‚ôÇÔ∏è –£–¥–∞–ª—è–µ–º—Å—è –æ—Ç —Ü–µ–ª–∏';
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–∞–π–¥–µ—Ä—ã
                    distanceSlider.value = distance;
                    updateValues();
                }
            });
            
            startMovementSimulationBtn.textContent = '‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
            statusDisplay.textContent = 'üèÉ‚Äç‚ôÇÔ∏è –°–∏–º—É–ª—è—Ü–∏—è –¥–≤–∏–∂–µ–Ω–∏—è';
            statusDisplay.className = 'status navigating';
        }
        
        function stopMovementSimulationMode() {
            stopMovementSimulation();
            simulationPanel.style.display = 'none';
            startMovementSimulationBtn.textContent = 'üèÉ‚Äç‚ôÇÔ∏è –°–∏–º—É–ª—è—Ü–∏—è';
            statusDisplay.textContent = '–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é';
            statusDisplay.className = 'status';
        }
        
        // –ê–≤—Ç–æ—Ç–µ—Å—Ç
        function startAutoTest() {
            if (autoTestInterval) {
                clearInterval(autoTestInterval);
                autoTestInterval = null;
                startAutoTestBtn.textContent = 'üéØ –ê–≤—Ç–æ—Ç–µ—Å—Ç';
                stopContinuousPlay(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
                return;
            }
            
            if (!isAudioOn()) {
                alert('–í–∫–ª—é—á–∏—Ç–µ –∑–≤—É–∫ –¥–ª—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞!');
                return;
            }
            
            stopContinuousPlay(); // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
            startAutoTestBtn.textContent = '‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
            
            // –ê–≤—Ç–æ—Ç–µ—Å—Ç: –º–µ–Ω—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫–∏
            let testStep = 0;
            const testCases = [
                { distance: 20, speed: 2, desc: '–ë–ª–∏–∑–∫–æ + –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ' },
                { distance: 20, speed: -2, desc: '–ë–ª–∏–∑–∫–æ + –£–¥–∞–ª–µ–Ω–∏–µ' },
                { distance: 100, speed: 1, desc: '–°—Ä–µ–¥–Ω–µ + –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ' },
                { distance: 100, speed: -1, desc: '–°—Ä–µ–¥–Ω–µ + –£–¥–∞–ª–µ–Ω–∏–µ' },
                { distance: 180, speed: 0.5, desc: '–î–∞–ª–µ–∫–æ + –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ' },
                { distance: 180, speed: -0.5, desc: '–î–∞–ª–µ–∫–æ + –£–¥–∞–ª–µ–Ω–∏–µ' }
            ];
            
            autoTestInterval = setInterval(() => {
                const testCase = testCases[testStep % testCases.length];
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ª–∞–π–¥–µ—Ä—ã
                distanceSlider.value = testCase.distance;
                speedSlider.value = testCase.speed;
                updateValues();
                
                // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫
                playTestSound(testCase.distance, testCase.speed);
                
                testStep++;
            }, 3000);
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
        const startContinuousPlayBtn = document.getElementById('startContinuousPlay');
        
        audioToggle.addEventListener('click', () => {
            const isOn = toggleAudio();
            audioToggle.textContent = isOn ? 'üîä –û—Ç–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫' : 'üîá –í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫';
            audioToggle.className = `audio-toggle ${isOn ? 'active' : ''}`;
        });
        
        playTestBtn.addEventListener('click', playTest);
        playVictoryBtn.addEventListener('click', () => {
            if (!isAudioOn()) {
                alert('–í–∫–ª—é—á–∏—Ç–µ –∑–≤—É–∫ –¥–ª—è –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è!');
                return;
            }
            createVictorySound();
            statusDisplay.textContent = 'üèÜ –ó–≤—É–∫ –ø–æ–±–µ–¥—ã –ø—Ä–æ–∏–≥—Ä–∞–Ω!';
            statusDisplay.className = 'status reached';
        });
        startContinuousPlayBtn.addEventListener('click', () => {
            if (isContinuousPlaying) {
                stopContinuousPlay();
                startContinuousPlayBtn.textContent = 'üîÑ –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ';
            } else {
                startContinuousPlay();
                startContinuousPlayBtn.textContent = '‚èπÔ∏è –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
            }
        });
        startMovementSimulationBtn.addEventListener('click', () => {
            const status = getSimulationStatus();
            if (status.isRunning) {
                stopMovementSimulationMode();
            } else {
                startMovementSimulationMode();
            }
        });
        startAutoTestBtn.addEventListener('click', startAutoTest);
        
        distanceSlider.addEventListener('input', () => {
            updateValues();
            // –ï—Å–ª–∏ –∏–≥—Ä–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            if (isContinuousPlaying) {
                stopContinuousPlay();
                startContinuousPlay();
            }
        });
        
        speedSlider.addEventListener('input', () => {
            updateValues();
            // –ï—Å–ª–∏ –∏–≥—Ä–∞–µ—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å –Ω–æ–≤—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
            if (isContinuousPlaying) {
                stopContinuousPlay();
                startContinuousPlay();
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø—Ä–∏–º–µ—Ä–æ–≤
        document.querySelectorAll('.example-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const distance = parseFloat(btn.dataset.distance);
                const speed = parseFloat(btn.dataset.speed);
                
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
                stopContinuousPlay();
                if (autoTestInterval) {
                    clearInterval(autoTestInterval);
                    autoTestInterval = null;
                    startAutoTestBtn.textContent = 'üéØ –ê–≤—Ç–æ—Ç–µ—Å—Ç';
                }
                
                distanceSlider.value = distance;
                speedSlider.value = speed;
                updateValues();
                
                setTimeout(() => {
                    playTest();
                }, 100);
            });
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        updateValues();
        
        console.log('üéµ –û—Ç–ª–∞–¥–∫–∞ –∑–≤—É–∫–æ–≤–æ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
    </script>
</body>
</html>
